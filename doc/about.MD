## 电子相册（模板驱动 + AI）PRD v0.3（快速落地版）

> 核心目标：用户批量导入手机相册照片，AI 辅助生成图文与趣味符号，即可发布一个带动效与音乐的 H5 相册链接并分享。

### 1. 产品定位与边界
- 产品定位：主题化、轻制作、高完成率的电子相册生成器（优先“小程序”体验）。
- 首版策略：模板驱动为主，编辑为辅；不做“从零画布局”作为主路径。
- 默认流程：选主题与模板 -> 批量导入照片 -> 自动按规则填充 -> AI 生成图文与符号（可编辑）-> 少量微调 -> 发布 -> 分享链接。

#### 1.1 目标人群与价值主张（首版聚焦）
- 核心人群：愿意记录生活、重视审美与仪式感的用户（尤其是女性用户更高频）
- 关键痛点：照片多但难整理、难成册、难“好看”、难快速分享
- 核心承诺：不用会排版，导入就成册；不用会写文案，AI 一键出图文

#### 1.2 版本边界（发布与分享）
- 本地预览：小程序内预览播放，不依赖发布。
- 发布分享（MVP）：发布为 H5 相册链接，可在微信内打开播放并转发。
- 高级分享（后续）：访问权限（仅自己/口令/过期）、数据统计（播放/转发）、更强的动效与音乐资源包。

#### 1.3 宣传口径（产品话术）
- 核心口号：接入 AI，一键出片
- 主打文案：豆包更懂你的创作

### 2. 主题（首发三套核心主题）
#### 2.1 青春毕业（青春纪念）
- 氛围：雾蓝/奶白/浅紫 + 玻璃卡片叠层 + 轻噪点
- 贴纸方向：胶带、拍立得边框、纸张撕边、手写涂鸦、签名笔划
- 关键表单字段（用于模板占位符）：
  - schoolName、className、year、ownerName、slogan
  - messageToFriends（寄语）、messageFromTeacher（可选）
  - peopleList（可选：同学名单）
- 推荐 Room 模板（首发建议每套 6-10 页）：
  - 同学录封面（主合影 + 班级名 + 年份）
  - 成长时间轴（按拍摄时间自动排序）
  - 合影中心页（主图 + 小图环绕）
  - 留言墙/签名墙（文本位为主，照片为辅）

#### 2.2 马年新年（家人团聚）
- 氛围关键词：精致年味、喜庆但不俗、暖光团聚、轻奢金粉
- 视觉主调：正红 + 香槟金 + 米白留白 + 暖黑压重（避免大面积纯红“糊”）
- 贴纸方向：灯笼、窗花、烟花、福字、祥云、春联角标、红包、马纹/马蹄印、奔跑线条、生肖印章
- 动效方向（H5）：金粉飘落、灯笼轻摆、纸张翻页、烟花点亮、剪纸投影（动效轻量优先）
- 音乐方向（H5）：国风轻鼓点/温暖新年 BGM（首版每主题 3-5 首，默认静音可播放）

马年新年主题资源包（首发必须）：
- 纹理：金箔纹理、宣纸纹理、磨砂玻璃噪点、灯笼暖光渐变
- 装饰组件：春联边框（上/下/左右）、福字角标、金粉描边框、窗花镂空框
- 生肖模块：马年封面章（“甲午/马年/新春”风格可选）、马元素边饰（不遮挡主体）
- 配色建议：
  - Primary：#C81E1E（年味红）
  - Accent：#F5C542（香槟金）
  - Background：#FFF6E8（米白）
  - Text：#1F1A17（暖黑）
  - Highlight：#EAB308（亮金，用于小面积点亮）

马年新年主题资源包细化（首发交付物）

封面样式（3 套）：
- A「春联灯笼·团圆封面」：
  - 构图：上下春联边框 + 中央主合影（拍立得/圆角玻璃卡片）+ 右上福字角标
  - 文字：主标题（家族/团圆主题）+ 年份 + 地点（可选）
  - 质感：磨砂玻璃 + 暖光渐变，金粉描边只做小面积
- B「金箔印章·轻奢封面」：
  - 构图：大留白米白底 + 中央主图（偏大）+ 左下/右下金箔生肖印章（马年）
  - 文字：短标题（8-12 字）+ 一句祝福（12-18 字）
  - 质感：宣纸纹理 + 金箔压印（阴影极克制，避免“网红风”高对比）
- C「窗花拼贴·年味相册封面」：
  - 构图：2-4 张小图拼贴（错位叠层）+ 窗花镂空框局部遮罩 + 一张主图压轴
  - 文字：标题 + 目录式副标题（如“年夜饭 / 拜年 / 合影”）
  - 质感：轻噪点 + 胶片闪白（动效模板可复用）

动效模板（3 套，轻量优先）
- T1「金粉入场」：
  - 节奏：封面 900-1200ms 入场，后续页 450-650ms
  - 动作：主图淡入 + 轻微推近；金粉粒子少量飘落（低密度）；文字延迟 120ms 出现
  - 适用：封面/留白文案/合影页（氛围感强但不喧宾夺主）
- T2「纸张翻页」：
  - 节奏：翻页 380-520ms，伴随纸张阴影与高光擦过（很轻）
  - 动作：页面边缘高光扫过 + 内容层轻微视差（可选）
  - 适用：章节页/时间轴/叙事页（“像一本年册”）
- T3「烟花点亮」：
  - 节奏：进入页先暗 120ms -> 亮起 300ms -> 稳定 200ms
  - 动作：背景小烟花/光点在角落点亮（不遮挡主体）+ 金色微光脉冲一次
  - 适用：拜年页/红包页/祝福页（庆祝感强，控制频率避免疲劳）

音乐（5 种推荐风格，按“精致年味”取向）
- M1 国风轻鼓点：低频鼓点 + 木鱼/手碟点缀，适合合影与热闹页
- M2 温暖弦乐与钢琴：柔和旋律，适合团圆与留白文案页
- M3 新年 Lo-fi：暖色合成器 + 低速节拍，适合拼贴与日常年味碎片
- M4 传统器乐轻编：古筝/笛子/琵琶轻编，适合拜年与仪式感页
- M5 喜庆但克制：更明亮的旋律线，但避免高强度锣鼓，适合封面与结尾页

页面类型与 AI 输出规则（马年主题专属）
- 通用约束：
  - 语气：温暖、精致、克制，不用土味口号，不用“过度鸡汤”
  - 标点：优先中文标点，感叹号最多 1 个/页
  - 符号点缀：每页最多 0-2 个（如“✨”“金粉”“小图标”），避免刷屏
  - 必含意象池（按页分布）：灯笼、窗花、春联、烟花、金粉、祥云、马蹄/奔跑
  - 禁用：低俗/网感词、夸张营销词、PUA 语气、过度谐音梗
- PageType=封面：
  - 标题：8-14 字；副标题：12-20 字；一句祝福：12-24 字（可选）
  - 关键词：马年、新春、团圆、年味、喜乐、平安
  - 避免：长段落、强口号、连续感叹号
- PageType=合影：
  - 页内段落：20-45 字；图注：8-16 字（最多 2 条）
  - 关键词：团聚、相见、笑意、家常、这一刻、热热闹闹
  - 适配：鼓励“具体细节”（谁在场、场景小细节），避免空泛
- PageType=年夜饭：
  - 页内段落：18-40 字；菜名/细节点：3-6 个短词（可选）
  - 关键词：烟火气、热气、香味、家宴、团圆饭、热腾腾
  - 适配：更偏“感官描述”（香/热/脆/甜）与“细碎幸福”
- PageType=拜年：
  - 祝福主句：12-22 字；补一句：12-22 字（可选）；图注：8-14 字
  - 关键词：拜年、顺遂、平安、喜乐、万事如意、心想事成
  - 避免：过度官方套话、重复“祝你新年快乐”每页都出现
- PageType=留白文案：
  - 文案：24-60 字（最多 2 段，每段 12-30 字）；标题：6-10 字（可选）
  - 关键词：年味、灯火、归家、温暖、慢慢来、好好生活
  - 适配：更像“纪念册旁白”，留空间给照片，不压视觉
- 关键表单字段：
  - year、familyName（可选）、location（可选）
  - blessingTitle（标题）、blessingText（祝福语）
  - members（可选：家庭成员称呼列表）
- 推荐 Room 模板：
  - 团圆合影封面（春联边框）
  - 年夜饭记录（九宫格/三栏拼贴）
  - 拜年页（祝福文案 + 福字角标）
  - 红包页（红包贴纸 + 家人称呼位）

#### 2.3 单身记录（孤独治愈）
- 氛围：低饱和灰蓝/米白 + 大留白 + 轻颗粒/胶片感
- 贴纸方向：日记便签、日期戳、咖啡杯、雨滴、月亮、城市剪影
- 关键表单字段：
  - year、month（可选）、city（可选）
  - selfTitle（标题）、selfText（独白/治愈文案）
  - habitTags（可选：标签，如“夜跑/读书/散步”）
- 推荐 Room 模板：
  - 日记封面（标题 + 日期 + 主图）
  - 一周碎片（7 格拼贴）
  - 城市漫游（地图/地点文本位 + 照片）
  - 治愈留白页（大文本 + 1-3 张重点照）

### 3. 核心概念与层级（模板驱动）
- Room：一本相册（由模板创建）
- Page：一页（每页可有照片区域 + 装饰文本/贴纸/形状）
- Layout：一页的照片区域布局（Region 的集合）
- Region：一个照片槽位（可能是不规则形状），有 order（用于“按序号填充”）
- Decoration：装饰层（文本/贴纸/形状），支持占位符与自动填充

层级模型：
- Room -> Pages -> Layout -> Regions + Decorations

### 4. 核心流程（小程序优先）
#### 4.1 用户流程（MVP）
- 选主题：毕业/马年新年/单身记录
- 选模板：选择一个 Room 模板（整册）
- 导入照片：一次多选导入（支持继续追加）
- 自动填充：按 Region.order + 排序规则，将照片填满各页
- AI 生成：一键生成标题/段落/图注/趣味符号/页面叙事（可重试）
- 微调（可选）：替换某张照片、交换顺序、编辑文字、切换音乐与动效
- 发布：生成一个 H5 相册链接
- 分享：转发链接（微信内打开播放），可选生成封面海报图用于二次传播

#### 4.2 自动填充规则（默认口径）
- 排序优先级：
  1) 拍摄时间（若能获取到可靠的时间信息）
  2) 文件名排序（含截图/导出图通常更稳定）
  3) 用户手动拖拽排序
- 填充策略：
  - 先填“主图位”（模板可标记 priority: hero）
  - 再按 Region.order 顺序填充
  - 不足时留空并显示“还差 N 张”

#### 4.3 照片有机整合（核心痛点能力）
目标：用户照片很多也不崩溃，系统把“很多张”变成“有结构、有节奏、有重点”的一本相册。

MVP 方案（不依赖复杂识别也能显著提升完成率）：
- 自动分组：按时间自动聚类成 3-8 个章节（可手动合并/拆分）
- 自动挑重点：从每组挑 1 张主图 + 若干辅图（规则：清晰度/人脸占比/曝光/时间间隔）
- 自动控密度：把 80-200 张照片压缩到 8-12 页，保证每页留白与呼吸感
- 自动控重复：连拍/相似图去重（优先保留更清晰/更亮/更完整的人像）
- 自动编排节奏：主图页 -> 细节页 -> 合影页 -> 文案留白页循环，避免“全是九宫格”

增强项（后续但建议预留架构接口）：
- 人像偏好：优先挑人像清晰、构图更好的照片（更贴合女性用户拍照习惯）
- 场景标注：年夜饭/拜年/出行/合影等章节标签（用于模板页的标题与贴纸建议）

### 5. 数据模型（落地结构，建议）
#### 5.1 Room
- id: string
- name: string
- themeId: "graduation" | "horseNewYear" | "soloHealing" | string
- templateId: string
- pages: Page[]
- formData: Record<string, string | string[] | number | boolean>
- createdAt: number
- updatedAt: number
- version: number

#### 5.2 Page
- id: string
- name?: string
- sizePreset: "A4" | "9:16" | "1:1"
- layoutId: string
- cellStates: Record<regionId, CellState>
- decorations: Decoration[]
- background: Background
- filter: PageFilter

#### 5.3 Layout / Region
- Layout:
  - id: string
  - name: string
  - cols: number
  - rows: number
  - regions: Region[]
- Region:
  - id: string
  - order: number
  - role?: "hero" | "normal"
  - cells: Array<[x: number, y: number]>

#### 5.4 CellState（每个 Region 的图片与视图）
- regionId: string
- assetId?: string
- fitMode: "cover" | "contain"
- pan: { x: number; y: number }
- zoom: number
- rotate: 0 | 90 | 180 | 270

#### 5.5 Asset（图片资源）
- id: string
- name: string
- mime: string
- width: number
- height: number
- size: number
- source: "web" | "miniProgram"
- capturedAt?: number
- storageKey: string

#### 5.6 Decoration（装饰元素）
- id: string
- type: "text" | "sticker" | "shape"
- transform: { x: number; y: number; scaleX: number; scaleY: number; rotation: number }
- style: Record<string, unknown>
- zIndex: number
- text?: string
- textBindings?: Array<{ key: string; mode: "replace" | "append" }>

#### 5.7 Template（模板体系）
- RoomTemplate：
  - id: string
  - themeId: string
  - name: string
  - pages: Array<{ pageId: string; layoutId: string; decorations: Decoration[]; background: Background; filter: PageFilter }>
  - formSchema: Array<{ key: string; label: string; type: "text" | "textarea" | "tags" | "list"; required: boolean; maxLen?: number }>
- LayoutTemplate：复用 Layout，供不同 RoomTemplate 引用

#### 5.8 本地持久化策略（MVP）
- Web：IndexedDB 存图片二进制与项目 JSON，localStorage 存轻量索引。
- 小程序：优先走本地存储 + 文件系统缓存；项目过大时提示“清理缓存/仅导出不保存”。
- 自动保存：编辑行为后 2-5 秒节流写入；退出前强制保存。
- 版本与兼容：数据结构带 version 字段，升级时做迁移。

### 6. 相册导入与“原数据”获取（小程序优先的现实口径）
#### 6.1 关键现实约束
- 小程序无法无授权、无选择地“扫描整个相册”；通常需要用户在系统选择器中勾选照片后返回临时路径。
- 获取到的元数据粒度与稳定性取决于平台与接口返回，拍摄时间/地理位置不一定能直接拿到。

#### 6.2 可落地方案（从强到弱）
- A（理想）：用户选择照片后，尝试在客户端解析图片 EXIF，提取拍摄时间 capturedAt。
- B（稳妥）：用文件名/选择顺序作为排序依据，提供“一键倒序/手动排序”兜底。
- C（补救）：允许用户设置“这一组照片的起始日期/章节标题”，用于时间轴模板的文本，而不强依赖 EXIF。

#### 6.3 与体验强相关的产品要求
- 导入后立即显示“排序方式”：拍摄时间/文件名/手动。
- 时间轴模板必须能在没有 EXIF 的情况下正常工作（降级到手动排序 + 手动日期）。

#### 6.4 AI 辅助创作（火山引擎 Doubao API（AK/SK 签名））
目标：用户只需导入照片，图文、表情符号与“氛围文案”主要由 AI 生成，用户只做选择与微调。

输入：
- 用户选择的主题与模板
- 照片（默认上传压缩图用于理解；原图用于最终发布的高清展示）
- 可选的少量信息：姓名/年份/地点/关系称呼/心情关键词

输出（MVP 必做）：
- 相册标题、副标题、封面一句话
- 每页段落文案（短文为主，避免大段长文）
- 每张图的图注候选（可一键替换）
- 趣味符号/表情/标点装饰（与主题风格一致）

输出（增强项）：
- 自动分章节与章节标题（毕业：相识/比赛/合影/告别；新年：团圆/年夜饭/拜年；治愈：独处/散步/夜跑）
- 音乐推荐（风格标签 + 备选曲目），并与页面节奏匹配
- 贴纸与装饰建议（在不遮挡主体的前提下给出位置与强度）

交互与控制：
- 文风选择：温暖/幽默/克制/文艺（默认随主题）
- 强度滑杆：少量点缀 / 明显氛围
- 一键重试：按“保留结构/重写风格/更短/更活泼”重试
- 可编辑：AI 生成内容全部可编辑，且支持“撤回到模板默认”

主题约束与“调教”策略（让 AI 更像产品的一部分）：
- 主题 Prompt Pack：每个主题维护一套固定约束（关键词、禁用词、口吻、标点风格、表情符号集合、长度上限）
- 模板约束注入：把模板的页面类型（封面/时间轴/合影/留白）与可用装饰位一并喂给 AI，输出更贴合版式
- 马年新年专属约束（示例口径）：
  - 必须包含：新年/团圆/年味/祝福（按页分布，不要每页都重复）
  - 可用意象：灯笼、窗花、春联、烟花、金粉、马蹄、奔跑、祥云
  - 风格：精致、温暖、轻奢；避免土味网感与过度夸张口号
  - 文本长度：封面 8-18 字；页内 20-60 字；图注 8-20 字
- 输出校验：长度、敏感内容、重复度、主题一致性不达标则自动重试或降级为模板默认文案

安全与合规（必须）：
- 内容安全过滤：涉政/涉黄/暴恐/辱骂等自动拒绝或降级为模板默认文案
- 隐私策略：明确告知“压缩图用于 AI 理解”，支持关闭 AI（纯模板模式）
- 成本控制：分批请求与缓存（同一照片 + 同一模板 + 同一风格结果可复用）

### 7. 发布与分享（H5 相册链接）
#### 7.1 发布形态（MVP）
- 发布结果：一个可在微信内打开播放的 H5 相册链接
- H5 播放器能力：页切换动效、沉浸式全屏、音乐开关、加载进度、封面与目录（可选）
- 分享物料：自动生成一张封面海报图（含标题与二维码/链接引导）

#### 7.2 音乐与动效（体验上限）
- 音乐策略：
  - 默认提供主题配乐（首版每主题 3-5 首）
  - 由于浏览器限制，首次播放需要用户点击触发音频
- 动效策略：
  - 模板自带动效（轻量优先）：淡入、推拉、胶片闪白、纸张翻页
  - 支持 prefers-reduced-motion（在 H5 端自动降级为轻动效）

#### 7.3 发布链路（技术口径）
- 上传：图片（多档清晰度）+ 相册 JSON（页面结构/文案/音乐/动效配置）
- 托管：对象存储 + CDN
- H5 加载：先骨架屏与封面，边播边预加载后续页资源

#### 7.4 权限与可控（后续）
- 可选权限：仅自己可见、口令分享、过期时间、禁止下载
- 可选水印：默认轻水印或可关闭

### 8. 性能与限制（首版约束）
- 单个 Room 最大页数：10
- 单页 Region 数：建议 ≤ 100
- 单次导入图片数量：建议 ≤ 60（可分批追加）
- 单张图片最大体积：建议 ≤ 20MB；超限提示并可跳过

### 9. 里程碑（按“最快出片”排序）
- M1：模板成册 + 发布链接（选模板 -> 导入 -> 自动填充 -> 发布 H5 -> 分享）
- M2：AI 文案与符号（火山引擎 Doubao API（AK/SK 签名））（一键生成 -> 选择/重试 -> 可编辑）
- M3：播放器体验（音乐/动效/预加载/封面海报）
- M4：微调工具（换图/交换/文本编辑/音乐切换）
- M5：资源包扩展（每主题 4-6 套 Room 模板 + 动效 + 音乐 + 贴纸）
- M6：高级能力（权限体系、数据统计、模板工坊、更多编辑）

### 10. 技术栈选择（不受当前仓库限制的推荐方案）
#### 10.1 总体原则
- 小程序优先：把“导入相册 -> 自动成册 -> AI 生成 -> 发布分享”的链路做到极短、极稳。
- 模板数据驱动：主题、模板、贴纸、字体、配色全部可配置，避免硬编码到 UI。
- 核心能力可复用：尽量让“数据模型、模板引擎、自动填充、渲染导出”跨端复用。

#### 10.2 端侧技术选型（推荐）
- 小程序端（主端）：
  - 优先：微信小程序原生（WXML/WXSS/TS）+ 组件化（性能与能力最稳）
  - 可选：Taro（React）或 uni-app（Vue）做跨端（人效更高，但要约束复杂渲染与组件层级）
- Web 端（副端）：
  - Next.js / Vite 任一即可，目标是“在线预览 + 模板工坊 + 运营页”，不强依赖复杂编辑
- 代码组织（强烈推荐）：
  - Monorepo（pnpm + Turborepo）：
    - packages/core：数据模型、模板绑定、自动填充、排序、迁移
    - packages/render：页面渲染抽象（渲染指令、排版计算、裁切/适配）
    - packages/storage：本地持久化抽象（web IndexedDB / 小程序文件系统）
    - apps/mini：小程序
    - apps/web：Web 预览与运营

#### 10.3 渲染与发布（决定体验上限）
- 预览策略（小程序内）：
  - 轻量：小程序原生页面做分页预览（用于编辑确认）
  - 增强：WebView 打开 H5 播放器做“所见即所得”预览
- 发布策略（MVP）：
  - 上传图片多规格（缩略/中清/高清）与 album.json（模板与 AI 文案结果）
  - H5 播放器按模板配置渲染动效、加载音乐并进行资源预加载
- 稳定性策略：
  - 首屏只加载封面 + 1-2 页，后续滚动预取
  - 失败降级：动效降级、音乐关闭、图片降清晰度

#### 10.4 图片导入与元数据（小程序最佳实践）
- 导入能力：
  - 使用系统相册选择器多选，返回临时文件路径
  - 导入后立即生成缩略图（用于编辑预览与流畅滚动）
- 元数据获取策略：
  - 尝试 EXIF（capturedAt）解析成功则用于排序
  - 失败则降级为“选择顺序/文件名/手动排序”
  - 时间轴模板不强依赖 EXIF：允许用户手动输入“起始日期/章节标题”
- 性能策略：
  - 大图不直接进内存做全量处理，先做缩略图与延迟加载
  - 做导入队列与并发限制，避免卡死或闪退

#### 10.5 发布与分享的后端与云服务选型（从一开始就需要）
- 推荐路径 A（最快落地，小程序友好）：微信云开发 CloudBase
  - 鉴权：微信登录态
  - 存储：云存储（图片多规格、音乐、模板资源、album.json）
  - 数据库：云数据库（作品索引、分享记录、权限、AI 生成记录）
  - 云函数：发布编排、资源处理、鉴权校验、内容安全、AI 调用（火山引擎 Doubao API（AK/SK 签名））
- 推荐路径 B（更通用、更强可控）：自建轻后端 + 对象存储 + CDN
  - API：Node.js（NestJS/Fastify）或 Serverless（Cloudflare Workers）
  - 存储：COS/OSS/S3 + CDN
  - 数据库：PostgreSQL（作品、模板版本、分享权限、AI 记录、发布任务）
  - 异步任务：队列（BullMQ/Cloud Tasks）处理资源转换、内容审核、AI 调用

### 11. 系统架构（最小闭环到可规模化）
#### 11.1 核心模块
- Template Pack：主题资源包（模板 JSON、贴纸 SVG、字体、配色、预览图）
- Album Engine：创建 Room、自动填充、文本占位符绑定、迁移与版本兼容
- Import Pipeline：相册导入、缩略图生成、元数据提取、排序与分组
- Editor Shell：页列表、页预览、字段表单、少量微调（换图/交换/文本编辑）
- AI Creative（火山引擎 Doubao API（AK/SK 签名））：图文生成、符号点缀、章节结构、音乐与贴纸建议
- Publish Service：上传、资源多规格处理、album.json 生成、内容安全、发布任务编排
- H5 Player：播放渲染（动效/音乐/预加载/降级）、分享落地页、二维码/海报生成

#### 11.2 “模板驱动”的实现口径
- 模板只做两件事：
  - 定义页面结构：Layout（Regions）+ Decorations + 背景/滤镜
  - 定义可编辑字段：formSchema + 绑定规则（textBindings）
- 编辑器只做三件事：
  - 让用户导入照片并填满
  - 让 AI 生成图文并允许用户改少量字
  - 让用户发布并分享

### 12. 页面信息架构（小程序）
- 首页：主题入口（毕业/马年新年/单身治愈）+ 最近作品
- 模板列表：按主题展示 Room 模板（卡片预览 + 页数 + 需照片数）
- 模板详情：预览整册缩略图 + 一键使用 + 推荐导入数量提示
- 导入照片：多选导入 + 排序方式选择 + 还差 N 张提示
- AI 创作：一键生成（标题/段落/图注/符号）+ 文风选择 + 重试
- 编辑预览：页列表 + 当前页预览 + 快捷操作（换图/交换/编辑文本）
- 预览播放：沉浸式播放 + 音乐开关 + 封面海报预览
- 发布分享：发布进度 + 失败重试 + 生成链接 + 一键转发 + 海报下载
- 作品库：作品列表（删除/重命名/继续编辑/再次发布）

### 13. 工程化任务拆分（可直接排期）
#### 13.1 M1（最小闭环：模板成册与发布链接）
- 模板加载：主题与 Room 模板列表、模板详情预览
- 导入链路：多选导入 -> 生成 Asset -> 缩略图生成 -> 列表预览
- 自动填充：按 Region.order 填充，缺图提示，支持追加导入
- 发布链路：上传资源 -> 生成 album.json -> 产出 H5 链接 -> 小程序内预览打开

验收口径：
- 新用户从打开到发布并分享首个成品不超过 3 分钟
- H5 在微信内打开首屏加载 < 2s（常规网络下的目标口径）

#### 13.2 M2（火山引擎 Doubao API（AK/SK 签名）：显著提升“精美感”与差异化）
- AI 生成：标题/段落/图注/趣味符号（按主题与文风输出）
- 交互：文风选择、强度调节、一键重试、可编辑与撤回
- 合规：内容安全过滤、敏感内容降级、用户关闭 AI 的纯模板模式
 
验收口径：
- 只导入照片 + 点一次生成，成品文案可直接发布且不违和
- AI 生成失败时自动回退为模板默认文案，流程不断

#### 13.3 M3（播放器体验：动效与音乐）
- H5 播放器：页切换动效、音乐开关、预加载、降级策略
- 分享物料：封面海报自动生成（用于朋友圈/群分享）

验收口径：
- 同一相册在不同机型上播放流畅且不白屏

#### 13.4 M4（微调：让用户愿意分享）
- 换图：点击槽位 -> 重新选择图片
- 交换：两槽位交换（保留各自裁切参数或整体交换）
- 文本编辑：选中文本装饰 -> 编辑内容与基础样式（字号/颜色/对齐）

验收口径：
- 用户能在 30 秒内修正“这张不想要/顺序不对/字不合适”的问题

### 14. 风险与关键取舍（深度评估版）
#### 14.1 技术实现挑战
- **跨端渲染一致性（高风险）**：
  - 问题：小程序 (WXML/Canvas 2D) 与 H5 (DOM/Canvas) 渲染引擎不同，字体行高、字间距、图片裁切可能存在像素级差异。
  - 对策：数据层使用相对单位 (%)；文本渲染若要求极致还原，需在 H5 端模拟小程序排版行为或使用 Canvas 渲染核心卡片；接受“95% 还原度”的妥协。
- **本地存储瓶颈**：
  - 问题：小程序本地存储限制 (10MB) 极易被大图 Base64 撑爆。
  - 对策：严格依赖文件系统 (FileSystemManager) 存储图片路径，仅存储 JSON 数据在 Storage；定期清理过期临时文件。
- **EXIF 数据碎片化**：
  - 问题：不同 Android 机型、微信压缩后的图片、截图均可能丢失拍摄时间/地点。
  - 对策：放弃“全自动完美时间轴”的幻想，模板必须支持“无时间”降级（如仅按导入顺序），并提供手动修改日期的入口。

#### 14.2 产品体验陷阱
- **音乐自动播放限制**：
  - 问题：主流浏览器与微信 WebView 禁止带声音的自动播放。
  - 对策：首屏设计“拆信/开启”等强交互引导，用户点击后解锁 AudioContext；默认静音播放，提供显眼的声音开关。
- **AI 延迟与焦虑**：
  - 问题：批量生成 10 页文案可能耗时 10s+，阻塞用户操作会造成流失。
  - 对策：采用“乐观 UI”（Optimistic UI），先用模板默认文案填充，AI 结果流式回来后无感替换，并显示“AI 正在优化文案...”的状态提示。

#### 14.3 成本与合规
- **CDN 流量成本**：
  - 问题：用户上传原图 (10MB+) 若直接分发，H5 访问流量费将极其昂贵且加载慢。
  - 对策：上传链路强制压缩；服务端/CDN 侧做多规格分发 (WebP + 缩略图)；大图仅在全屏查看时加载。
- **内容安全（红线）**：
  - 问题：用户生成涉黄/涉政内容分享导致小程序被封禁。
  - 对策：接入微信内容安全 API（文本+图片）；发布前强制审核；建立黑名单机制。
